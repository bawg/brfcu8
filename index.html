<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Barnes Rugby - Coaching Management Platform</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #0f172a;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            min-height: 100vh;
        }
        
        /* === LOGIN STYLES === */
        #loginContainer {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 24px;
        }
        
        .login-card {
            background: white;
            padding: 48px;
            border-radius: 16px;
            box-shadow: 0 25px 50px -12px rgba(15, 23, 42, 0.5);
            width: 100%;
            max-width: 420px;
            border: 1px solid #e2e8f0;
        }
        
        .login-header {
            text-align: center;
            margin-bottom: 32px;
        }
        
        .login-title {
            font-size: 2rem;
            font-weight: 700;
            color: #1e3a8a;
            margin-bottom: 8px;
        }
        
        .login-subtitle {
            color: #64748b;
            font-size: 1rem;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #1e3a8a;
            font-size: 14px;
        }
        
        .form-input-login {
            width: 100%;
            padding: 16px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
            background: white;
            transition: all 0.2s ease;
            color: #374151;
        }
        
        .form-input-login:focus {
            outline: none;
            border-color: #1e3a8a;
            box-shadow: 0 0 0 3px rgba(30, 58, 138, 0.1);
        }
        
        .btn-login {
            width: 100%;
            padding: 16px;
            background: #1e3a8a;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-bottom: 12px;
        }
        
        .btn-login:hover:not(:disabled) {
            background: #3730a3;
            transform: translateY(-1px);
        }
        
        .btn-login:disabled {
            background: #9ca3af;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-signup {
            width: 100%;
            padding: 16px;
            background: white;
            color: #1e3a8a;
            border: 2px solid #1e3a8a;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .btn-signup:hover:not(:disabled) {
            background: #1e3a8a;
            color: white;
        }
        
        .btn-signup:disabled {
            background: #f3f4f6;
            color: #9ca3af;
            border-color: #d1d5db;
            cursor: not-allowed;
        }
        
        .auth-message {
            margin-top: 16px;
        }
        
        .error-message {
            background: #fef2f2;
            border: 1px solid #fecaca;
            color: #dc2626;
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 14px;
        }
        
        .success-message {
            background: #f0fdf4;
            border: 1px solid #bbf7d0;
            color: #16a34a;
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 14px;
        }
        
        .loading-message {
            background: #eff6ff;
            border: 1px solid #bfdbfe;
            color: #1d4ed8;
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 14px;
        }
        
        /* === USER INFO BAR === */
        .user-info-bar {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: white;
            padding: 12px 24px;
            margin-bottom: 24px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
        }
        
        .user-details {
            display: flex;
            align-items: center;
            gap: 16px;
        }
        
        .logout-btn {
            background: rgba(239, 68, 68, 0.8);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            transition: all 0.2s ease;
        }
        
        .logout-btn:hover {
            background: rgba(239, 68, 68, 1);
        }
        
        .hidden {
            display: none !important;
        }
        
        /* Loading spinner */
        .spinner {
            border: 2px solid #f3f3f3;
            border-top: 2px solid #1e3a8a;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-right: 8px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* === EXISTING STYLES (keeping your original styles) === */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 24px;
            background: transparent;
        }
        
        .header {
            background: linear-gradient(135deg, #0f172a, #1e293b);
            color: white;
            padding: 32px;
            border-radius: 12px;
            margin-bottom: 32px;
            box-shadow: 0 10px 25px -5px rgba(15, 23, 42, 0.4), 0 10px 10px -5px rgba(15, 23, 42, 0.06);
        }
        
        .header h1 {
            font-size: 2.25rem;
            font-weight: 700;
            text-align: center;
            margin-bottom: 8px;
        }
        
        .header p {
            text-align: center;
            font-size: 1.125rem;
            font-weight: 500;
            opacity: 0.9;
        }
        
        .mockup-nav {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 32px;
            flex-wrap: wrap;
            background: white;
            padding: 8px;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(15, 23, 42, 0.2);
            border: 1px solid #334155;
        }
        
        .mockup-btn {
            background: transparent;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            color: #64748b;
            transition: all 0.2s ease;
            font-size: 14px;
        }
        
        .mockup-btn:hover {
            background: #f1f5f9;
            color: #1e3a8a;
        }
        
        .mockup-btn.active {
            background: #1e3a8a;
            color: white;
        }
        
        .mockup-section {
            display: none;
            background: white;
            border-radius: 12px;
            padding: 32px;
            box-shadow: 0 4px 6px -1px rgba(30, 58, 138, 0.1), 0 2px 4px -1px rgba(30, 58, 138, 0.06);
            border: 1px solid #e2e8f0;
        }
        
        .mockup-section.active {
            display: block;
            animation: fadeIn 0.3s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 32px;
            padding-bottom: 16px;
            border-bottom: 2px solid #e2e8f0;
        }
        
        .section-title {
            color: #1e3a8a;
            font-size: 1.875rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        
        
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div id="loginContainer">
        <div class="login-card">
            <div class="login-header">
                <h1 class="login-title">Barnes Rugby</h1>
                <p class="login-subtitle">Coaching Management Platform</p>
            </div>
            
            <form id="loginForm">
                <div class="form-group">
                    <label class="form-label" for="email">Email Address</label>
                    <input type="email" id="email" class="form-input-login" placeholder="Enter your email" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="password">Password</label>
                    <input type="password" id="password" class="form-input-login" placeholder="Enter your password" required>
                </div>
                
                <button type="submit" id="loginBtn" class="btn-login">Sign In</button>
                <button type="button" id="signupBtn" class="btn-signup">Create Account</button>
            </form>
            
            <div id="authMessage" class="auth-message"></div>
        </div>
    </div>

    <!-- Main Application (Hidden until authenticated) -->
    <div id="appContainer" class="hidden">
        <!-- User Info Bar -->
        <div class="user-info-bar">
            <div class="user-details">
                <span>🏉 Welcome, <strong id="userEmailDisplay"></strong></span>
                <span>•</span>
                <span>ID: <span id="userIdDisplay"></span></span>
            </div>
            <button id="logoutBtn" class="logout-btn">Sign Out</button>
        </div>

        <div class="container">
            <header class="header">
                <h1>Barnes Rugby - Coaching Platform</h1>
                <p>Professional drill management and practice calendar system</p>
            </header>
            
            <!-- Your existing app content goes here -->
        <nav class="mockup-nav">
            <button class="mockup-btn" onclick="showSection('drills')">Drills</button>
            <button class="mockup-btn active" onclick="showSection('calendar')">Practice Calendar</button>
            <button class="mockup-btn" onclick="showSection('overview')">System</button>
            <button class="mockup-btn" onclick="showSection('design-drill')">Design Drill</button>
        </nav>
        
        <!-- Drills Section -->
        <section id="drills" class="mockup-section">
            <div class="section-header">
                <h2 class="section-title">📋 Drills Management</h2>
                <button class="add-btn" onclick="toggleDrillForm()">
                    <span>+</span> Add New Drill
                </button>
            </div>
            
            <div id="drill-success" class="success-message">
                Drill added successfully!
            </div>
            
            <!-- Upload Section (Initially Hidden) -->
            <div id="drill-form" style="display: none;">
                <div class="form-mockup">
                    <h3 style="margin-bottom: 24px; color: #1e3a8a; font-weight: 600;">Drill Information</h3>
                    <div class="form-grid">
                        <div class="form-field">
                            <label class="form-label" for="drill-name">Drill Name</label>
                            <input class="form-input" id="drill-name" type="text" placeholder="Enter drill name" required>
                        </div>
                        <div class="form-field">
                            <label class="form-label" for="drill-skill">Skill</label>
                            <select class="form-input" id="drill-skill" required>
                                <option value="">Select skill</option>
                                <option value="Passing">Passing</option>
                                <option value="Awareness">Awareness</option>
                                <option value="Defense">Defense</option>
                            </select>
                        </div>
                        <div class="form-field full-width" style="display: flex; flex-direction: row; align-items: flex-end; gap: 12px;">
                            <div style="flex:1;">
                                <label class="form-label" for="drill-duration">Duration</label>
                                <select class="form-input" id="drill-duration" required>
                                    <option value="">Select duration</option>
                                    <option value="15 minutes">15 min</option>
                                    <option value="30 minutes">30 min</option>
                                    <option value="45 minutes">45 min</option>
                                    <option value="60 minutes">60 min</option>
                                </select>
                            </div>
                            <a href="try.html">
                                <button type="button" class="btn-primary" style="margin-bottom:0;">Design Drill</button>
                            </a>
                        </div>
                        <div class="form-field full-width">
                            <label class="form-label" for="drill-description">Description</label>
                            <textarea class="form-input" id="drill-description" rows="2" placeholder="Enter drill description" required></textarea>
                        </div>
                    </div>
                    
                    <div style="margin: 24px 0;">
                        <label class="form-label" style="margin-bottom: 12px; display: block;">Upload Supporting Document (Optional)</label>
                        <div class="file-upload" onclick="handleFileUpload()">
                            <div class="upload-icon">📄</div>
                            <div class="upload-text">Upload Drill Document</div>
                            <div class="upload-subtext">Drop your PowerPoint, Word, or PDF document here, or click to browse</div>
                            <div class="upload-subtext" style="margin-top: 8px;">Supported formats: .pptx, .docx, .pdf (Max 10MB)</div>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 12px; justify-content: flex-end; margin-top: 24px;">
                        <button class="btn-secondary" onclick="toggleDrillForm()">Cancel</button>
                        <button class="btn-primary" onclick="addDrillToRepository()">Save Drill</button>
                    </div>
                </div>
            </div>

            <h3 style="margin: 32px 0 24px 0; color: #1e3a8a; font-weight: 600; font-size: 1.5rem;">📊 Drill Repository</h3>
            
            <input type="text" class="search-box" placeholder="🔍 Search drills by name, skill, or description..." oninput="filterDrills()">
            
            <div class="filters">
                <button class="filter-btn active" onclick="filterBySkill('all')">All Skills</button>
                <button class="filter-btn" onclick="filterBySkill('Passing')">Passing</button>
                <button class="filter-btn" onclick="filterBySkill('Awareness')">Awareness</button>
                <button class="filter-btn" onclick="filterBySkill('Defense')">Defense</button>
            </div>
            
            <div class="filters">
                <button class="filter-btn active" onclick="filterByDuration('all')">All Durations</button>
                <button class="filter-btn" onclick="filterByDuration('15 minutes')">15 min</button>
                <button class="filter-btn" onclick="filterByDuration('30 minutes')">30 min</button>
                <button class="filter-btn" onclick="filterByDuration('45 minutes')">45 min</button>
                <button class="filter-btn" onclick="filterByDuration('60 minutes')">60 min</button>
            </div>
            
            <div class="table-container">
                <div class="table-header">
                    <div>Drill Name & Description</div>
                    <div>Skill</div>
                    <div>Duration</div>
                    <div>Actions</div>
                </div>
                <div id="drill-table-body" class="table-body">
                    <!-- Drill rows will be added here dynamically -->
                </div>
            </div>
        </section>

        <!-- Calendar Section -->
        <section id="calendar" class="mockup-section active">
            <div class="section-header">
                <h2 class="section-title">📅 Practice Calendar</h2>
                <button class="add-btn" onclick="showAddEventModal()">
                    <span>+</span> Add Event
                </button>
            </div>
            
            <div class="calendar-view">
                <div class="calendar-header">
                    <button class="nav-btn" onclick="navigateMonth(-1)">‹</button>
                    <h3 id="current-month">January 2025</h3>
                    <button class="nav-btn" onclick="navigateMonth(1)">›</button>
                </div>
                
                <div class="calendar-grid">
                    <div class="day-header">Sun</div>
                    <div class="day-header">Mon</div>
                    <div class="day-header">Tue</div>
                    <div class="day-header">Wed</div>
                    <div class="day-header">Thu</div>
                    <div class="day-header">Fri</div>
                    <div class="day-header">Sat</div>
                    
                    <!-- Calendar days will be generated here -->
                    <div id="calendar-days"></div>
                </div>
            </div>
            
            <div class="events-sidebar">
                <h3>Upcoming Events</h3>
                <div id="events-list"></div>
            </div>
        </section>

        <!-- System Overview Section -->
        <section id="overview" class="mockup-section">
            <div class="section-header">
                <h2 class="section-title">📊 System Overview</h2>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="total-drills">12</div>
                    <div class="stat-label">Total Drills</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="upcoming-events">3</div>
                    <div class="stat-label">Upcoming Events</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="this-month-practices">8</div>
                    <div class="stat-label">This Month's Practices</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="active-players">24</div>
                    <div class="stat-label">Active Players</div>
                </div>
            </div>
            
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <h3>🔧 System Configuration</h3>
                    <p>Configure team settings, player management, and system preferences.</p>
                    <button class="btn-primary" onclick="showConfigModal()">Open Settings</button>
                </div>
                <div class="dashboard-card">
                    <h3>📊 Team Analytics</h3>
                    <p>View performance metrics, attendance tracking, and progress reports.</p>
                    <button class="btn-secondary" onclick="showAnalyticsModal()">View Analytics</button>
                </div>
                <div class="dashboard-card">
                    <h3>📝 Quick Actions</h3>
                    <p>Quickly add events, drills, or manage team information.</p>
                    <div style="display: flex; gap: 8px; margin-top: 12px;">
                        <button class="btn-small" onclick="showAddEventModal()">Add Event</button>
                        <button class="btn-small" onclick="toggleDrillForm()">Add Drill</button>
                    </div>
                </div>
                <div class="dashboard-card">
                    <h3>🚨 Issues & Support</h3>
                    <p>Log system issues or view existing problem reports.</p>
                    <div style="display: flex; gap: 8px; margin-top: 12px;">
                        <button class="btn-small" onclick="showLogIssueForm()">Log Issue</button>
                        <button class="btn-small" onclick="showIssuesTable()">View Issues</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Design Drill Section -->
        <section id="design-drill" class="mockup-section">
            <div class="section-header">
                <h2 class="section-title">🎨 Design Drill</h2>
            </div>
            
            <div class="design-drill-content">
                <div class="design-card">
                    <div class="design-icon">🎯</div>
                    <h3>Interactive Drill Designer</h3>
                    <p>Create custom rugby drills with our visual drag-and-drop interface. Design formations, set player movements, and add timing annotations.</p>
                    <a href="try.html" style="text-decoration: none;">
                        <button class="btn-primary" style="width: 100%; margin-top: 16px;">
                            Launch Drill Designer
                        </button>
                    </a>
                </div>
                
                <div class="design-features">
                    <h3>Design Features</h3>
                    <ul>
                        <li>Visual field layout with rugby pitch dimensions</li>
                        <li>Drag-and-drop player positioning</li>
                        <li>Movement path creation with timing</li>
                        <li>Equipment and cone placement</li>
                        <li>Export to PDF or image formats</li>
                        <li>Save to drill repository</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Add Event Modal -->
        <div id="eventModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Add New Event</h3>
                    <button class="modal-close" onclick="closeAddEventModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-grid">
                        <div class="form-field">
                            <label class="form-label" for="event-name">Event Name</label>
                            <input class="form-input" id="event-name" type="text" placeholder="Enter event name" required>
                        </div>
                        <div class="form-field">
                            <label class="form-label" for="event-type">Event Type</label>
                            <select class="form-input" id="event-type" required>
                                <option value="">Select type</option>
                                <option value="practice">Practice</option>
                                <option value="match">Match</option>
                                <option value="tournament">Tournament</option>
                                <option value="meeting">Team Meeting</option>
                                <option value="festival">Festival</option>
                            </select>
                        </div>
                        <div class="form-field">
                            <label class="form-label" for="event-date">Date</label>
                            <input class="form-input" id="event-date" type="date" required>
                        </div>
                        <div class="form-field">
                            <label class="form-label" for="event-time">Time</label>
                            <input class="form-input" id="event-time" type="time" required>
                        </div>
                        <div class="form-field full-width">
                            <label class="form-label" for="event-location">Location</label>
                            <input class="form-input" id="event-location" type="text" placeholder="Enter location" required>
                        </div>
                        <div class="form-field full-width">
                            <label class="form-label" for="event-details">Details</label>
                            <textarea class="form-input" id="event-details" rows="3" placeholder="Enter event details"></textarea>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn-secondary" onclick="closeAddEventModal()">Cancel</button>
                    <button class="btn-primary" onclick="addEvent()">Add Event</button>
                </div>
            </div>
        </div>

        <!-- Configuration Modal -->
        <div id="configModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>System Configuration</h3>
                    <button class="modal-close" onclick="closeConfigModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="config-section">
                        <h4>Team Settings</h4>
                        <div class="form-grid">
                            <div class="form-field">
                                <label class="form-label" for="team-name">Team Name</label>
                                <input class="form-input" id="team-name" type="text" value="Barnes Rugby Club" required>
                            </div>
                            <div class="form-field">
                                <label class="form-label" for="coach-name">Head Coach</label>
                                <input class="form-input" id="coach-name" type="text" value="John Smith" required>
                            </div>
                        </div>
                    </div>
                    
                    <div class="config-section">
                        <h4>System Preferences</h4>
                        <div class="form-grid">
                            <div class="form-field">
                                <label class="form-label" for="default-practice-duration">Default Practice Duration</label>
                                <select class="form-input" id="default-practice-duration">
                                    <option value="90">90 minutes</option>
                                    <option value="120" selected>120 minutes</option>
                                    <option value="150">150 minutes</option>
                                </select>
                            </div>
                            <div class="form-field">
                                <label class="form-label" for="calendar-view">Default Calendar View</label>
                                <select class="form-input" id="calendar-view">
                                    <option value="month" selected>Monthly</option>
                                    <option value="week">Weekly</option>
                                    <option value="list">List View</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn-secondary" onclick="closeConfigModal()">Cancel</button>
                    <button class="btn-primary" onclick="saveConfig()">Save Settings</button>
                </div>
            </div>
        </div>

        <!-- Analytics Modal -->
        <div id="analyticsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Team Analytics</h3>
                    <button class="modal-close" onclick="closeAnalyticsModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="analytics-section">
                        <h4>Attendance Overview</h4>
                        <div class="analytics-chart">
                            <div class="chart-placeholder">
                                📊 Attendance tracking chart would be displayed here
                            </div>
                        </div>
                    </div>
                    
                    <div class="analytics-section">
                        <h4>Performance Metrics</h4>
                        <div class="metrics-grid">
                            <div class="metric-item">
                                <span class="metric-label">Average Attendance:</span>
                                <span class="metric-value">87%</span>
                            </div>
                            <div class="metric-item">
                                <span class="metric-label">Practices This Month:</span>
                                <span class="metric-value">8</span>
                            </div>
                            <div class="metric-item">
                                <span class="metric-label">Total Training Hours:</span>
                                <span class="metric-value">24.5h</span>
                            </div>
                            <div class="metric-item">
                                <span class="metric-label">Most Used Drill:</span>
                                <span class="metric-value">Passing Lines</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn-primary" onclick="closeAnalyticsModal()">Close</button>
                </div>
            </div>
        </div>

        <!-- Log Issue Modal -->
        <div id="logIssueModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Log System Issue</h3>
                    <button class="modal-close" onclick="closeLogIssueModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-grid">
                        <div class="form-field full-width">
                            <label class="form-label" for="issue-title">Issue Title</label>
                            <input class="form-input" id="issue-title" type="text" placeholder="Brief description of the issue" required>
                        </div>
                        <div class="form-field full-width">
                            <label class="form-label" for="issue-description">Detailed Description</label>
                            <textarea class="form-input" id="issue-description" rows="4" placeholder="Provide detailed information about the issue, including steps to reproduce if applicable" required></textarea>
                        </div>
                    </div>
                    <div id="upload-status-issues" class="upload-status" style="display: none;"></div>
                </div>
                <div class="modal-footer">
                    <button class="btn-secondary" onclick="closeLogIssueModal()">Cancel</button>
                    <button class="btn-primary" onclick="saveIssue()">Log Issue</button>
                </div>
            </div>
        </div>

        <!-- Issues Table Modal -->
        <div id="issuesTableModal" class="modal">
            <div class="modal-content" style="max-width: 900px;">
                <div class="modal-header">
                    <h3>System Issues</h3>
                    <button class="modal-close" onclick="closeIssuesTableModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="table-container">
                        <div class="table-header">
                            <div style="flex: 2;">Issue Title</div>
                            <div style="flex: 3;">Description</div>
                            <div style="flex: 1;">Date Logged</div>
                            <div style="flex: 1;">Status</div>
                        </div>
                        <div id="issues-table-body" class="table-body">
                            <!-- Issue rows will be added here dynamically -->
                        </div>
                        <div id="no-issues-message" style="text-align: center; padding: 40px; color: #64748b;">
                            No issues have been logged yet.
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn-primary" onclick="closeIssuesTableModal()">Close</button>
                </div>
            </div>
        </div>

    <script>
        // ====== BARNES RUGBY COACHING PLATFORM ======
        
        // Current date and calendar state
        let currentDate = new Date();
        let currentMonth = currentDate.getMonth();
        let currentYear = currentDate.getFullYear();
        
        // Sample events data - in a real app, this would come from a database
        const events = [
            { date: '2025-01-02', time: '6:00 PM - 8:00 PM', type: 'practice', name: 'Practice', location: 'Barnes Rugby Field', details: 'First practice of the year. Focus on passing drills.', attendees: ['Alice', 'Bob', 'Charlie'] },
            { date: '2025-01-05', time: '7:00 PM - 9:00 PM', type: 'practice', name: 'Training', location: 'Barnes Rugby Field', details: 'Skills training session.', attendees: ['Alice', 'David', 'Eve'] },
            { date: '2025-01-12', time: '2:00 PM - 5:00 PM', type: 'match', name: 'Championship Match', location: 'Away Ground', details: 'Important league match.', attendees: ['Full Squad'] },
            { date: '2025-01-13', time: '6:30 PM - 8:30 PM', type: 'practice', name: 'Practice', location: 'Barnes Rugby Field', details: 'Defensive drills and positioning.', attendees: ['Bob', 'Charlie', 'Eve'] },
            { date: '2025-01-18', time: '10:00 AM - 1:00 PM', type: 'tournament', name: 'Regional Tournament', location: 'Regional Sports Complex', details: 'Regional championship tournament.', attendees: ['Full Squad'] },
            { date: '2025-01-20', time: '7:00 PM - 9:00 PM', type: 'practice', name: 'Training', location: 'Barnes Rugby Field', details: 'Tactical training session.', attendees: ['Alice', 'Bob', 'Charlie', 'David', 'Eve'] },
            { date: '2025-01-25', time: '11:00 AM - 1:00 PM', type: 'meeting', name: 'Team Meeting', location: 'Clubhouse', details: 'Monthly team meeting and strategy discussion.', attendees: ['All Players', 'Coaching Staff'] },
            { date: '2025-01-27', time: '3:00 PM - 5:00 PM', type: 'practice', name: 'Match Day', location: 'Barnes Rugby Field', details: 'Friendly match.', attendees: ['Full Squad'] },
            { date: '2025-01-29', time: '10:00 AM - 4:00 PM', type: 'festival', name: 'Spring Festival', location: 'Barnes Rugby Field', details: 'Spring rugby festival.', attendees: ['All Teams'] }
        ];
        
        // Sample drills data
        const drills = [
            { id: 1, name: 'Basic Passing Lines', skill: 'Passing', duration: '15 minutes', description: 'Simple passing drill in lines to warm up players and improve accuracy.' },
            { id: 2, name: 'Overlap Attacks', skill: 'Passing', duration: '30 minutes', description: 'Advanced passing drill focusing on creating and exploiting overlaps.' },
            { id: 3, name: 'Tackle Technique', skill: 'Defense', duration: '45 minutes', description: 'Fundamental tackling technique practice with progression levels.' },
            { id: 4, name: 'Spatial Awareness', skill: 'Awareness', duration: '30 minutes', description: 'Improve player awareness of space and positioning on the field.' }
        ];
        
        // Sample issues data
        const issues = [
            { id: 1, title: 'Calendar sync issue', description: 'Events not syncing properly with external calendars', dateLogged: '2024-12-15', status: 'Open' },
            { id: 2, title: 'File upload timeout', description: 'Large drill documents timing out during upload', dateLogged: '2024-12-10', status: 'Open' }
        ];

        // Application state
        let activeFilters = {
            skill: 'all',
            duration: 'all'
        };

        // Navigation function
        function showSection(sectionName) {
            // Hide all sections
            document.querySelectorAll('.mockup-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remove active class from all nav buttons
            document.querySelectorAll('.mockup-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(sectionName).classList.add('active');
            
            // Add active class to clicked button
            event.target.classList.add('active');
            
            // Initialize section-specific content
            if (sectionName === 'calendar') {
                renderCalendar();
                renderEventsList();
            } else if (sectionName === 'drills') {
                renderDrillsTable();
            }
        }

        // Calendar functions
        function renderCalendar() {
            const daysContainer = document.getElementById('calendar-days');
            const monthTitle = document.getElementById('current-month');
            
            // Clear previous days
            daysContainer.innerHTML = '';
            
            // Set month title
            const monthNames = ['January', 'February', 'March', 'April', 'May', 'June',
                              'July', 'August', 'September', 'October', 'November', 'December'];
            monthTitle.textContent = `${monthNames[currentMonth]} ${currentYear}`;
            
            // Get first day of month and number of days
            const firstDay = new Date(currentYear, currentMonth, 1).getDay();
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            
            // Add empty cells for days before month starts
            for (let i = 0; i < firstDay; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.className = 'calendar-day empty';
                daysContainer.appendChild(emptyDay);
            }
            
            // Add days of the month
            for (let day = 1; day <= daysInMonth; day++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                dayElement.textContent = day;
                
                // Check if this day has events
                const dateString = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const dayEvents = events.filter(event => event.date === dateString);
                
                if (dayEvents.length > 0) {
                    dayElement.classList.add('has-events');
                    
                    // Add event indicators
                    dayEvents.forEach(event => {
                        const eventDot = document.createElement('div');
                        eventDot.className = `event-dot ${event.type}`;
                        eventDot.title = `${event.name} - ${event.time}`;
                        dayElement.appendChild(eventDot);
                    });
                }
                
                // Highlight today
                if (currentYear === new Date().getFullYear() && 
                    currentMonth === new Date().getMonth() && 
                    day === new Date().getDate()) {
                    dayElement.classList.add('today');
                }
                
                daysContainer.appendChild(dayElement);
            }
        }

        function navigateMonth(direction) {
            currentMonth += direction;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            } else if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            renderCalendar();
        }

        function renderEventsList() {
            const eventsList = document.getElementById('events-list');
            
            // Filter upcoming events (next 30 days)
            const today = new Date();
            const thirtyDaysFromNow = new Date(today.getTime() + (30 * 24 * 60 * 60 * 1000));
            
            const upcomingEvents = events.filter(event => {
                const eventDate = new Date(event.date);
                return eventDate >= today && eventDate <= thirtyDaysFromNow;
            }).sort((a, b) => new Date(a.date) - new Date(b.date));
            
            eventsList.innerHTML = '';
            
            if (upcomingEvents.length === 0) {
                eventsList.innerHTML = '<div class="no-events">No upcoming events</div>';
                return;
            }
            
            upcomingEvents.forEach(event => {
                const eventElement = document.createElement('div');
                eventElement.className = `event-item ${event.type}`;
                eventElement.innerHTML = `
                    <div class="event-date">${new Date(event.date).toLocaleDateString()}</div>
                    <div class="event-info">
                        <div class="event-name">${event.name}</div>
                        <div class="event-time">${event.time}</div>
                        <div class="event-location">${event.location}</div>
                    </div>
                `;
                eventsList.appendChild(eventElement);
            });
        }

        // Event management functions
        function showAddEventModal() {
            document.getElementById('eventModal').style.display = 'flex';
        }

        function closeAddEventModal() {
            document.getElementById('eventModal').style.display = 'none';
        }

        function addEvent() {
            const name = document.getElementById('event-name').value;
            const type = document.getElementById('event-type').value;
            const date = document.getElementById('event-date').value;
            const time = document.getElementById('event-time').value;
            const location = document.getElementById('event-location').value;
            const details = document.getElementById('event-details').value;
            
            if (!name || !type || !date || !time || !location) {
                alert('Please fill in all required fields');
                return;
            }
            
            // Create time range (assuming 2-hour duration)
            const startTime = time;
            const endTimeDate = new Date(`2000-01-01 ${time}`);
            endTimeDate.setHours(endTimeDate.getHours() + 2);
            const endTime = endTimeDate.toTimeString().slice(0, 5);
            
            const newEvent = {
                date: date,
                time: `${startTime} - ${endTime}`,
                type: type,
                name: name,
                location: location,
                details: details || '',
                attendees: []
            };
            
            events.push(newEvent);
            
            // Refresh calendar and events list
            renderCalendar();
            renderEventsList();
            
            // Clear form and close modal
            document.getElementById('event-name').value = '';
            document.getElementById('event-type').value = '';
            document.getElementById('event-date').value = '';
            document.getElementById('event-time').value = '';
            document.getElementById('event-location').value = '';
            document.getElementById('event-details').value = '';
            
            closeAddEventModal();
        }

        // Drill management functions
        function toggleDrillForm() {
            const form = document.getElementById('drill-form');
            form.style.display = form.style.display === 'none' ? 'block' : 'none';
            
            if (form.style.display === 'block') {
                document.getElementById('drill-name').focus();
            }
        }

        function addDrillToRepository() {
            const name = document.getElementById('drill-name').value;
            const skill = document.getElementById('drill-skill').value;
            const duration = document.getElementById('drill-duration').value;
            const description = document.getElementById('drill-description').value;
            
            if (!name || !skill || !duration || !description) {
                alert('Please fill in all fields');
                return;
            }
            
            const newDrill = {
                id: drills.length + 1,
                name: name,
                skill: skill,
                duration: duration,
                description: description
            };
            
            drills.push(newDrill);
            
            // Show success message
            const successMsg = document.getElementById('drill-success');
            successMsg.style.display = 'block';
            setTimeout(() => {
                successMsg.style.display = 'none';
            }, 3000);
            
            // Clear form and hide it
            document.getElementById('drill-name').value = '';
            document.getElementById('drill-skill').value = '';
            document.getElementById('drill-duration').value = '';
            document.getElementById('drill-description').value = '';
            toggleDrillForm();
            
            // Refresh drills table
            renderDrillsTable();
            
            // Update stats
            document.getElementById('total-drills').textContent = drills.length;
        }

        function renderDrillsTable() {
            const tableBody = document.getElementById('drill-table-body');
            tableBody.innerHTML = '';
            
            // Filter drills based on active filters
            let filteredDrills = drills;
            
            if (activeFilters.skill !== 'all') {
                filteredDrills = filteredDrills.filter(drill => drill.skill === activeFilters.skill);
            }
            
            if (activeFilters.duration !== 'all') {
                filteredDrills = filteredDrills.filter(drill => drill.duration === activeFilters.duration);
            }
            
            // Apply search filter if exists
            const searchTerm = document.querySelector('.search-box').value.toLowerCase();
            if (searchTerm) {
                filteredDrills = filteredDrills.filter(drill => 
                    drill.name.toLowerCase().includes(searchTerm) ||
                    drill.skill.toLowerCase().includes(searchTerm) ||
                    drill.description.toLowerCase().includes(searchTerm)
                );
            }
            
            filteredDrills.forEach(drill => {
                const row = document.createElement('div');
                row.className = 'table-row';
                row.innerHTML = `
                    <div>
                        <div style="font-weight: 600; margin-bottom: 4px;">${drill.name}</div>
                        <div style="color: #64748b; font-size: 0.9rem;">${drill.description}</div>
                    </div>
                    <div><span class="skill-badge ${drill.skill.toLowerCase()}">${drill.skill}</span></div>
                    <div>${drill.duration}</div>
                    <div>
                        <button class="btn-small" onclick="editDrill(${drill.id})">Edit</button>
                        <button class="btn-small btn-danger" onclick="deleteDrill(${drill.id})">Delete</button>
                    </div>
                `;
                tableBody.appendChild(row);
            });
            
            if (filteredDrills.length === 0) {
                tableBody.innerHTML = '<div style="text-align: center; padding: 40px; color: #64748b;">No drills found matching your criteria.</div>';
            }
        }

        function filterBySkill(skill) {
            activeFilters.skill = skill;
            
            // Update button states
            document.querySelectorAll('.filter-btn').forEach(btn => {
                if (btn.textContent.includes('All Skills') && skill === 'all') {
                    btn.classList.add('active');
                } else if (btn.textContent === skill) {
                    btn.classList.add('active');
                } else if (!btn.textContent.includes('All Durations') && !btn.textContent.includes('min')) {
                    btn.classList.remove('active');
                }
            });
            
            renderDrillsTable();
        }

        function filterByDuration(duration) {
            activeFilters.duration = duration;
            
            // Update button states
            document.querySelectorAll('.filter-btn').forEach(btn => {
                if (btn.textContent.includes('All Durations') && duration === 'all') {
                    btn.classList.add('active');
                } else if (btn.textContent.includes('min') && btn.textContent.includes(duration.split(' ')[0])) {
                    btn.classList.add('active');
                } else if (btn.textContent.includes('min') || btn.textContent.includes('All Durations')) {
                    btn.classList.remove('active');
                }
            });
            
            renderDrillsTable();
        }

        function filterDrills() {
            renderDrillsTable();
        }

        function editDrill(id) {
            // In a real app, this would open an edit modal
            alert(`Edit drill functionality would open here for drill ID: ${id}`);
        }

        function deleteDrill(id) {
            if (confirm('Are you sure you want to delete this drill?')) {
                const index = drills.findIndex(drill => drill.id === id);
                if (index > -1) {
                    drills.splice(index, 1);
                    renderDrillsTable();
                    document.getElementById('total-drills').textContent = drills.length;
                }
            }
        }

        function handleFileUpload() {
            // In a real app, this would handle file upload
            alert('File upload functionality would be implemented here');
        }

        // Configuration functions
        function showConfigModal() {
            document.getElementById('configModal').style.display = 'flex';
        }

        function closeConfigModal() {
            document.getElementById('configModal').style.display = 'none';
        }

        function saveConfig() {
            // In a real app, this would save configuration to database
            alert('Configuration saved successfully!');
            closeConfigModal();
        }

        // Analytics functions
        function showAnalyticsModal() {
            document.getElementById('analyticsModal').style.display = 'flex';
        }

        function closeAnalyticsModal() {
            document.getElementById('analyticsModal').style.display = 'none';
        }

        // Issue Management Functions
        function showLogIssueForm() {
            document.getElementById('logIssueModal').style.display = 'flex';
            // Clear form fields
            document.getElementById('issue-title').value = '';
            document.getElementById('issue-description').value = '';
        }

        function closeLogIssueModal() {
            document.getElementById('logIssueModal').style.display = 'none';
        }

        function saveIssue() {
            const title = document.getElementById('issue-title').value.trim();
            const description = document.getElementById('issue-description').value.trim();
            
            if (!title || !description) {
                showIssueStatus('Please fill in both title and description.', 'error');
                return;
            }
            
            // Create new issue object
            const issue = {
                id: Date.now(), // Simple ID generation for frontend-only storage
                title: title,
                description: description,
                dateLogged: new Date().toISOString().split('T')[0], // YYYY-MM-DD format
                status: 'Open' // Default status
            };
            
            // Add to issues array
            issues.unshift(issue); // Add to beginning for newest first
            
            // Close modal and show success message
            closeLogIssueModal();
            showIssueStatus('Issue logged successfully!', 'success');
            
            // If issues table is open, refresh it
            if (document.getElementById('issuesTableModal').style.display === 'flex') {
                renderIssuesTable();
            }
        }

        function showIssuesTable() {
            document.getElementById('issuesTableModal').style.display = 'flex';
            renderIssuesTable();
        }

        function closeIssuesTableModal() {
            document.getElementById('issuesTableModal').style.display = 'none';
        }

        function renderIssuesTable() {
            const tableBody = document.getElementById('issues-table-body');
            const noIssuesMessage = document.getElementById('no-issues-message');
            
            if (issues.length === 0) {
                tableBody.style.display = 'none';
                noIssuesMessage.style.display = 'block';
                return;
            }
            
            tableBody.style.display = 'block';
            noIssuesMessage.style.display = 'none';
            
            tableBody.innerHTML = '';
            
            issues.forEach(issue => {
                const row = document.createElement('div');
                row.className = 'table-row';
                row.innerHTML = `
                    <div style="flex: 2; font-weight: 600;">${issue.title}</div>
                    <div style="flex: 3;">
                        <div style="max-height: 60px; overflow: hidden; text-overflow: ellipsis;">
                            ${issue.description}
                        </div>
                    </div>
                    <div style="flex: 1;">${issue.dateLogged}</div>
                    <div style="flex: 1;">
                        <span class="status-badge status-${issue.status.toLowerCase()}">${issue.status}</span>
                    </div>
                `;
                tableBody.appendChild(row);
            });
        }

        function showIssueStatus(message, type) {
            const statusDiv = document.getElementById('upload-status-issues');
            statusDiv.className = `upload-status ${type}`;
            statusDiv.textContent = message;
            statusDiv.style.display = 'block';
            
            // Hide after 3 seconds
            setTimeout(() => {
                statusDiv.style.display = 'none';
            }, 3000);
        }

        window.showSection = showSection;
    </script>
        </div>
    </div>

    <script>
        // ====== SECURE AUTHENTICATION SYSTEM ======
        // No Firebase keys - all authentication goes through Vercel APIs
        
        // DOM elements
        const loginContainer = document.getElementById('loginContainer');
        const appContainer = document.getElementById('appContainer');
        const loginForm = document.getElementById('loginForm');
        const loginBtn = document.getElementById('loginBtn');
        const signupBtn = document.getElementById('signupBtn');
        const logoutBtn = document.getElementById('logoutBtn');
        const authMessage = document.getElementById('authMessage');
        const userEmailDisplay = document.getElementById('userEmailDisplay');
        const userIdDisplay = document.getElementById('userIdDisplay');

        // Loading state
        let isLoading = false;

        // Show/hide content based on authentication state
        function toggleContent(isAuthenticated) {
            if (isAuthenticated) {
                loginContainer.classList.add('hidden');
                appContainer.classList.remove('hidden');
            } else {
                loginContainer.classList.remove('hidden');
                appContainer.classList.add('hidden');
            }
        }

        // Show message with different types
        function showMessage(message, type = 'error') {
            const className = type === 'error' ? 'error-message' : 
                            type === 'success' ? 'success-message' : 'loading-message';
            
            const spinner = type === 'loading' ? '<div class="spinner"></div>' : '';
            authMessage.innerHTML = `<div class="${className}">${spinner}${message}</div>`;
        }

        // Clear messages
        function clearMessage() {
            authMessage.innerHTML = '';
        }

        // Set loading state
        function setLoading(loading) {
            isLoading = loading;
            loginBtn.disabled = loading;
            signupBtn.disabled = loading;
            
            if (loading) {
                loginBtn.innerHTML = '<div class="spinner"></div>Signing In...';
                signupBtn.innerHTML = '<div class="spinner"></div>Creating Account...';
            } else {
                loginBtn.innerHTML = 'Sign In';
                signupBtn.innerHTML = 'Create Account';
            }
        }

        // Login function - calls your Vercel API
        async function loginUser(email, password) {
            try {
                setLoading(true);
                showMessage('Signing in...', 'loading');

                const response = await fetch('/api/auth/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ email, password }),
                });

                const data = await response.json();

                if (response.ok) {
                    // Success - update UI with user info
                    userEmailDisplay.textContent = data.user.email;
                    userIdDisplay.textContent = data.user.uid;
                    showMessage('Login successful!', 'success');
                    
                    setTimeout(() => {
                        toggleContent(true);
                        clearMessage();
                    }, 1000);
                } else {
                    // Error from API
                    showMessage(data.error || 'Login failed');
                }

            } catch (error) {
                console.error('Login error:', error);
                showMessage('Network error. Please try again.');
            } finally {
                setLoading(false);
            }
        }

        // Signup function - calls your Vercel API
        async function signupUser(email, password) {
            try {
                setLoading(true);
                showMessage('Creating account...', 'loading');

                const response = await fetch('/api/auth/signup', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ email, password }),
                });

                const data = await response.json();

                if (response.ok) {
                    // Success - update UI with user info
                    userEmailDisplay.textContent = data.user.email;
                    userIdDisplay.textContent = data.user.uid;
                    showMessage('Account created successfully!', 'success');
                    
                    setTimeout(() => {
                        toggleContent(true);
                        clearMessage();
                    }, 1000);
                } else {
                    // Error from API
                    showMessage(data.error || 'Account creation failed');
                }

            } catch (error) {
                console.error('Signup error:', error);
                showMessage('Network error. Please try again.');
            } finally {
                setLoading(false);
            }
        }

        // Logout function - calls your Vercel API
        async function logoutUser() {
            try {
                const response = await fetch('/api/auth/logout', {
                    method: 'POST',
                });

                const data = await response.json();

                if (response.ok) {
                    showMessage('Logged out successfully', 'success');
                    toggleContent(false);
                    loginForm.reset();
                    setTimeout(clearMessage, 2000);
                } else {
                    console.error('Logout error:', data.error);
                    // Even if logout API fails, clear the UI
                    toggleContent(false);
                    loginForm.reset();
                }

            } catch (error) {
                console.error('Logout error:', error);
                // Even if network fails, clear the UI
                toggleContent(false);
                loginForm.reset();
            }
        }

        // Verify authentication status on page load
        async function checkAuthStatus() {
            try {
                const response = await fetch('/api/auth/verify');
                const data = await response.json();

                if (response.ok && data.authenticated) {
                    // User is authenticated - show app
                    userEmailDisplay.textContent = data.user.email;
                    userIdDisplay.textContent = data.user.uid;
                    toggleContent(true);
                } else {
                    // User is not authenticated - show login
                    toggleContent(false);
                }

            } catch (error) {
                console.error('Auth check error:', error);
                // On error, assume not authenticated
                toggleContent(false);
            }
        }

        // Event listeners
        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            if (isLoading) return;
            
            const email = document.getElementById('email').value.trim();
            const password = document.getElementById('password').value;
            
            if (!email || !password) {
                showMessage('Please enter both email and password.');
                return;
            }
            
            loginUser(email, password);
        });

        signupBtn.addEventListener('click', (e) => {
            e.preventDefault();
            if (isLoading) return;
            
            const email = document.getElementById('email').value.trim();
            const password = document.getElementById('password').value;
            
            if (!email || !password) {
                showMessage('Please enter both email and password.');
                return;
            }
            
            if (password.length < 6) {
                showMessage('Password should be at least 6 characters.');
                return;
            }
            
            signupUser(email, password);
        });

        logoutBtn.addEventListener('click', logoutUser);

        // Check authentication status when page loads
        document.addEventListener('DOMContentLoaded', () => {
            checkAuthStatus();
        });

        // ====== YOUR EXISTING APP FUNCTIONS ======
        // Add your existing drill management and calendar JavaScript here
    </script>


</body>
</html>
